{"ast":null,"code":"import axios from \"axios\";\nexport const AUTH_START = \"AUTH_START\";\nexport const AUTH_SUCCESS = \"AUTH_SUCESS\";\nexport const AUTH_FAIL = \"AUTH_FAIL\";\nexport const AUTH_LOGOUT = \"AUTH_LOGOUT\";\nexport const authStart = () => {\n  return {\n    type: AUTH_START\n  };\n};\nexport const authSuccess = token => {\n  return {\n    type: AUTH_SUCCESS,\n    token: token\n  };\n};\nexport const authFail = error => {\n  return {\n    type: AUTH_FAIL,\n    error: error\n  };\n}; //logout function. Removes and resets items in local storage\n\nexport const logout = () => {\n  localStorage.removeItem(\"user\");\n  localStorage.removeItem(\"expirationDate\");\n}; //To trigger logout after a certain period of time of inactivity\n\nexport const checkAuthTimeout = expirationTime => {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(logout());\n    }, expirationTime * 1000);\n  };\n}; //Signup for first-timers\n\nexport const authSignup = (email, username, password1, password2) => {\n  return dispatch => {\n    dispatch(authStart()); //post new user to server\n\n    axios.post(\"http://127.0.0.1:8000/rest-auth/registration\", {\n      email: email,\n      username: username,\n      password1: password1,\n      password2: password2\n    }).then(res => {\n      //create a token for the new user\n      const token = res.data.key; //create a timestamp for when tehy logged in\n\n      const newDate = new Date();\n      const expirationDate = new Date(newDate.getTime() + 3600 * 1000); //store in local storage so refresh doesnt rest login status\n\n      localStorage.setItem(\"token\", token);\n      localStorage.setItem(\"expirationDate\", expirationDate);\n      dispatch(authSuccess(token));\n      dispatch(checkAuthTimeout(3600));\n    }).catch(error => {\n      //handle errors with the authFail function\n      dispatch(authFail(error));\n    });\n  };\n};\nexport const authLogin = (username, password) => {\n  return () => async dispatch => {\n    dispatch(authStart());\n    axios.post(\"http://127.0.0.1:8000/rest-auth/login\", {\n      username: username,\n      password: password\n    }).then(res => {\n      const token = res.data.key;\n      const newDate = new Date();\n      const expirationDate = new Date(newDate.getTime() + 3600 * 1000);\n      localStorage.setItem(\"token\", token);\n      localStorage.setItem(\"expirationDate\", expirationDate);\n      dispatch(authSuccess(token));\n      dispatch(checkAuthTimeout(3600));\n    }).catch(error => {\n      dispatch(authFail(error));\n    });\n  };\n};\nexport const authLogout = () => {\n  return {\n    type: AUTH_LOGOUT\n  };\n};\nexport const authCheckState = () => {\n  return () => async dispatch => {\n    const token = localStorage.getItem(\"token\");\n\n    if (token === undefined) {\n      dispatch(logout());\n    } else {\n      const storageDate = localStorage.getItem(\"expirationDate\");\n      const expirationDate = new Date(storageDate);\n\n      if (expirationDate <= new Date()) {\n        dispatch(logout());\n      } else {\n        dispatch(authSuccess(token));\n        dispatch(checkAuthTimeout((expirationDate.getTime() - new Date().getTime()) / 1000));\n      }\n    }\n  };\n};","map":{"version":3,"sources":["/Users/Tao.S/Desktop/WebDev/MA/Front-end/src/store/actions/auth_actions.tsx"],"names":["axios","AUTH_START","AUTH_SUCCESS","AUTH_FAIL","AUTH_LOGOUT","authStart","type","authSuccess","token","authFail","error","logout","localStorage","removeItem","checkAuthTimeout","expirationTime","dispatch","setTimeout","authSignup","email","username","password1","password2","post","then","res","data","key","newDate","Date","expirationDate","getTime","setItem","catch","authLogin","password","authLogout","authCheckState","getItem","undefined","storageDate"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\nexport const AUTH_START = \"AUTH_START\";\nexport const AUTH_SUCCESS = \"AUTH_SUCESS\";\nexport const AUTH_FAIL = \"AUTH_FAIL\";\nexport const AUTH_LOGOUT = \"AUTH_LOGOUT\";\n\n\nexport const authStart = () => {\n    return {\n        type: AUTH_START,\n    }\n}\n\nexport const authSuccess = (token: any) => {\n    return {\n        type: AUTH_SUCCESS,\n        token: token,\n    }\n}\n\nexport const authFail = (error: any) => {\n    return {\n        type: AUTH_FAIL,\n        error: error,\n    }\n}\n\n//logout function. Removes and resets items in local storage\nexport const logout = () => {\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"expirationDate\")\n}\n\n//To trigger logout after a certain period of time of inactivity\nexport const checkAuthTimeout = (expirationTime: number) => {\n    return (dispatch: any) => {\n        setTimeout(()=> {\n            dispatch(logout());\n        }, expirationTime * 1000)\n    }\n}\n\n//Signup for first-timers\nexport const authSignup = (email: string, username: string, password1: string | number, password2: string | number) => {\n    return (dispatch: any) => {\n        dispatch(authStart());\n        //post new user to server\n        axios.post(\"http://127.0.0.1:8000/rest-auth/registration\", {\n            email: email,\n            username: username,\n            password1: password1,\n            password2: password2,\n        })\n        .then(res => {\n            //create a token for the new user\n            const token = res.data.key;\n            //create a timestamp for when tehy logged in\n            const newDate = new Date();\n            const expirationDate: any = new Date(newDate.getTime() + 3600*1000);\n            //store in local storage so refresh doesnt rest login status\n            localStorage.setItem(\"token\", token);\n            localStorage.setItem(\"expirationDate\", expirationDate);\n            dispatch(authSuccess(token));\n            dispatch(checkAuthTimeout(3600));\n        })\n        .catch(error => {\n            //handle errors with the authFail function\n            dispatch(authFail(error))\n        })\n    }\n}\n\nexport const authLogin = (username: string, password: string | number) => {\n    return () => async(dispatch: any) => {\n        dispatch(authStart());\n        axios.post(\"http://127.0.0.1:8000/rest-auth/login\", {\n            username: username,\n            password: password\n        })\n        .then(res => {\n            const token = res.data.key;\n            const newDate = new Date();\n            const expirationDate: any = new Date(newDate.getTime() + 3600*1000);\n            localStorage.setItem(\"token\", token);\n            localStorage.setItem(\"expirationDate\", expirationDate);\n            dispatch(authSuccess(token));\n            dispatch(checkAuthTimeout(3600));\n        })\n        .catch(error => {\n            dispatch(authFail(error))\n        })\n    }\n}\n\nexport const authLogout = () => {\n    return {\n        type: AUTH_LOGOUT,\n    }\n}\n\nexport const authCheckState = () => {\n    return () => async(dispatch: any) => {\n        const token = localStorage.getItem(\"token\");\n        if (token === undefined){\n            dispatch(logout());\n        }\n        else {\n            const storageDate: any = localStorage.getItem(\"expirationDate\")\n            const expirationDate: any = new Date(storageDate);\n            if (expirationDate <= new Date()){\n                dispatch(logout());\n            }\n            else{\n                dispatch(authSuccess(token));\n                dispatch(checkAuthTimeout((expirationDate.getTime() - new Date().getTime())/1000));\n            }\n        }\n    }\n}\n\n"]},"metadata":{},"sourceType":"module"}