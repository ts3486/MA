{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import _slicedToArray from\"/Users/Tao.S/Desktop/WebDev/MA/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,useEffect}from\"react\";import'./PostComponent_style.tsx';import{PostWrapper}from\"./PostComponent_style\";import axios from\"axios\";import{connect}from\"react-redux\";import{Card,CardHeader,CardMedia,CardContent,CardActions,IconButton,Avatar}from\"@material-ui/core\";import MoreVertIcon from'@material-ui/icons/MoreVert';import FavoriteBorderIcon from'@material-ui/icons/FavoriteBorder';import FavoriteIcon from'@material-ui/icons/Favorite';export var PostComponent=function PostComponent(props){var _props$filename,_props$filename2,_props$filename3,_props$filename4;//Get images\nvar content=null;//check file format\nif((_props$filename=props.filename)===null||_props$filename===void 0?void 0:_props$filename.includes(\"jpg\")){content=/*#__PURE__*/_jsx(CardMedia,{style:{height:\"800px\",width:\"600px\"},component:\"img\",src:\"http://localhost:5000/posts/images/\"+props.filename,title:\"post content\"});}else if((_props$filename2=props.filename)===null||_props$filename2===void 0?void 0:_props$filename2.includes(\"jpeg\")){content=/*#__PURE__*/_jsx(CardMedia,{style:{height:\"800px\",width:\"600px\"},component:\"img\",src:\"http://localhost:5000/posts/images/\"+props.filename,title:\"post content\"});}else if((_props$filename3=props.filename)===null||_props$filename3===void 0?void 0:_props$filename3.includes(\"png\")){content=/*#__PURE__*/_jsx(CardMedia,{style:{height:\"800px\",width:\"600px\"},component:\"img\",src:\"http://localhost:5000/posts/images/\"+props.filename,title:\"post content\"});}else if((_props$filename4=props.filename)===null||_props$filename4===void 0?void 0:_props$filename4.includes(\"mov\")){content=/*#__PURE__*/_jsx(CardMedia,{style:{height:\"800px\",width:\"600px\"},component:\"video\",src:\"http://localhost:5000/posts/images/\"+props.filename,title:\"post content\",controls:true});};//Delete posts\n// const deleteHandler = () => {\n//     axios.delete(\"http://localhost:5000/posts/delete/\" + props.id).then(()=>{\n//         console.log(\"image \" + props.id + \" deleted\");\n//     })\n//     axios.delete(\"http://localhost:5000/posts/image/delete/\" + props.filename);\n//     window.location.reload();\n// };\n// const [username, setUsername] = useState();\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),filename=_useState2[0],setFilename=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),likes=_useState4[0],addLike=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),postLiked=_useState6[0],markPost=_useState6[1];useEffect(function(){var initialLikes=likes;//Get likes \nif(initialLikes===0){axios.get(\"http://localhost:5000/posts/\"+props.id).then(function(res){var currentLikes=res.data.likes;addLike(likes+currentLikes);//If user has liked before set liked as true.\nif(res.data.likedBy.includes(props.user.username)){markPost(true);}});}//Get user data\nvar fetchUserData=function fetchUserData(){axios.get(\"http://localhost:5000/users/profile/\"+props.username).then(function(res){setFilename(res.data.filename);});};fetchUserData();});//Send updated like data to db\nvar likeHandler=function likeHandler(updatedLikes){var Likes={id:props.id,likes:updatedLikes,likedBy:props.user.username};JSON.stringify(Likes);axios.post(\"http://localhost:5000/posts/like\",Likes).then(function(){console.log(\"like added\");});markPost(true);};//remove or update like data from db\nvar unlikeHandler=function unlikeHandler(updatedLikes){var Likes={id:props.id,likes:updatedLikes,likedBy:props.user.username};JSON.stringify(Likes);axios.post(\"http://localhost:5000/posts/like\",Likes).then(function(){console.log(\"like added\");});markPost(false);};return/*#__PURE__*/_jsx(PostWrapper,{children:/*#__PURE__*/_jsxs(Card,{className:\"post_container\",id:props.id,children:[/*#__PURE__*/_jsx(CardHeader,{className:\"cardheader\",avatar:/*#__PURE__*/_jsx(Avatar,{\"aria-label\":\"recipe\",className:\"avatar\",src:\"http://localhost:5000/posts/images/\"+filename,children:\" U \"}),action:/*#__PURE__*/_jsxs(IconButton,{\"aria-label\":\"settings\",children:[\" \",/*#__PURE__*/_jsx(MoreVertIcon,{})]}),title:props.username}),content,/*#__PURE__*/_jsx(CardActions,{className:\"CardActions\",children:postLiked?/*#__PURE__*/_jsxs(\"div\",{className:\"actionIcons\",children:[/*#__PURE__*/_jsx(FavoriteIcon,{className:\"likes\",onClick:function onClick(){addLike(likes-1);unlikeHandler(likes-1);}}),\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"likeNumber\",children:[\": \",likes]})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FavoriteBorderIcon,{className:\"likes\",onClick:function onClick(){addLike(likes+1);likeHandler(likes+1);}}),\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"likeNumber\",children:[\": \",likes]})]})}),/*#__PURE__*/_jsx(CardContent,{className:\"CardContent\",children:props.description})]})});};var mapStateToProps=function mapStateToProps(state){return{posts:state.posts.posts,user:state.auth.user,isAuthenticated:state.auth.token!==null};};export default connect(mapStateToProps)(PostComponent);","map":{"version":3,"sources":["/Users/Tao.S/Desktop/WebDev/MA/frontend/src/Components/Posts/PostComponent.tsx"],"names":["React","useState","useEffect","PostWrapper","axios","connect","Card","CardHeader","CardMedia","CardContent","CardActions","IconButton","Avatar","MoreVertIcon","FavoriteBorderIcon","FavoriteIcon","PostComponent","props","content","filename","includes","height","width","setFilename","likes","addLike","postLiked","markPost","initialLikes","get","id","then","res","currentLikes","data","likedBy","user","username","fetchUserData","likeHandler","updatedLikes","Likes","JSON","stringify","post","console","log","unlikeHandler","description","mapStateToProps","state","posts","auth","isAuthenticated","token"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport './PostComponent_style.tsx';\nimport { PostWrapper } from \"./PostComponent_style\";\nimport axios from \"axios\";\nimport {connect} from \"react-redux\";\nimport {Card, CardHeader, CardMedia, CardContent, CardActions, IconButton, Avatar} from \"@material-ui/core\";\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\n\n\ninterface Props {\n    id?: string;\n    username?: string;\n    filename?: string;\n    description?: string;\n    likes?: number;\n    imageId?: string;\n\n}\n\n\nexport const PostComponent: React.FC<Props> = (props: any) => {\n\n//Get images\n    let content = null;\n\n    //check file format\n    if (props.filename?.includes(\"jpg\")){\n        content = (\n            <CardMedia \n            style={{ height: \"800px\", width: \"600px\" }}\n            component=\"img\"\n            src={\"http://localhost:5000/posts/images/\" + props.filename} title=\"post content\"/>\n        );\n    }\n    else if (props.filename?.includes(\"jpeg\")){\n        content = (\n            <CardMedia \n            style={{ height: \"800px\", width: \"600px\" }}\n            component=\"img\"\n            src={\"http://localhost:5000/posts/images/\" + props.filename} title=\"post content\"/>\n        );\n    }\n    else if (props.filename?.includes(\"png\")){\n        content = (\n            <CardMedia \n            style={{ height: \"800px\", width: \"600px\" }}\n            component=\"img\"\n            src={\"http://localhost:5000/posts/images/\" + props.filename} title=\"post content\"/>\n        );\n    }\n    else if (props.filename?.includes(\"mov\")){\n        content = (\n            <CardMedia \n            style={{ height: \"800px\", width: \"600px\" }}\n            component=\"video\"\n            src={\"http://localhost:5000/posts/images/\" + props.filename} title=\"post content\" controls/>\n            );\n    };\n\n//Delete posts\n    // const deleteHandler = () => {\n    //     axios.delete(\"http://localhost:5000/posts/delete/\" + props.id).then(()=>{\n    //         console.log(\"image \" + props.id + \" deleted\");\n    //     })\n\n    //     axios.delete(\"http://localhost:5000/posts/image/delete/\" + props.filename);\n\n    //     window.location.reload();\n    // };\n\n    // const [username, setUsername] = useState();\n\n    const [filename, setFilename] = useState();\n\n\n\n    const [likes, addLike] = useState(0);\n    const [postLiked, markPost] = useState(false);\n    \n   \n    useEffect(() => {\n\n        let initialLikes = likes;\n        //Get likes \n        if(initialLikes === 0){\n            axios.get(\"http://localhost:5000/posts/\" + props.id).then((res: any) => {\n                let currentLikes = res.data.likes;\n                addLike(likes + currentLikes);\n\n                //If user has liked before set liked as true.\n                if(res.data.likedBy.includes(props.user.username)){\n                    markPost(true);\n                }\n            })\n        }\n        \n\n        //Get user data\n        const fetchUserData = () => {\n            axios.get(\"http://localhost:5000/users/profile/\" + props.username).then((res: any) => {\n\n                setFilename(res.data.filename);\n\n            })\n        };\n\n        fetchUserData();\n    });\n\n\n\n\n    interface likeData{\n        id: String | undefined,\n        likes: Number\n        likedBy: String [];\n    }\n\n    //Send updated like data to db\n    const likeHandler = (updatedLikes: number) => {\n\n        const Likes: likeData = {\n            id: props.id,\n            likes: updatedLikes,\n            likedBy: props.user.username,\n        }\n\n        JSON.stringify(Likes);\n\n        axios.post(\"http://localhost:5000/posts/like\", Likes)\n        .then(()=>{console.log(\"like added\")})\n\n        markPost(true);\n\n    };\n\n    //remove or update like data from db\n    const unlikeHandler = (updatedLikes: number) => {\n\n        const Likes: likeData = {\n            id: props.id,\n            likes: updatedLikes,\n            likedBy: props.user.username\n        }\n\n        JSON.stringify(Likes);\n\n        axios.post(\"http://localhost:5000/posts/like\", Likes)\n        .then(()=>{console.log(\"like added\")})\n\n        markPost(false);\n\n    }\n\n\n\n    return( \n        <PostWrapper>\n             \n            <Card className=\"post_container\" id={props.id} >\n\n                <CardHeader className=\"cardheader\" \n                    avatar={<Avatar aria-label=\"recipe\" className=\"avatar\" src={\"http://localhost:5000/posts/images/\" + filename}> U </Avatar>} \n                    action={<IconButton aria-label=\"settings\"> <MoreVertIcon /></IconButton>}\n                    title={props.username}/>\n                    \n                {/* Image or Video */}\n                {content}\n\n                {/* {props.isAuthenticated ?  */}\n                <CardActions className=\"CardActions\">\n                    {postLiked ? \n                    <div className=\"actionIcons\">\n                    <FavoriteIcon className=\"likes\" onClick={() => {addLike(likes - 1); unlikeHandler(likes - 1);}}/> <div className=\"likeNumber\">: {likes}</div>\n                    </div>\n                    :\n                    <div>\n                    <FavoriteBorderIcon className=\"likes\" onClick={() => {addLike(likes + 1); likeHandler(likes + 1);}}/> <div className=\"likeNumber\">: {likes}</div>\n                    </div>\n                    }               \n                    {/* You use the empty function to not pass the event to the function. instead it`s just a trigger to activate the function */}\n                    {/* <DeleteIcon className=\"button\" onClick={deleteHandler}/> */}\n                </CardActions>\n                {/* : null  }             */}\n\n                <CardContent className=\"CardContent\">{props.description}</CardContent>\n\n            </Card>\n        </PostWrapper>\n    )\n\n}\n\nconst mapStateToProps = (state: any) => {\n    return{\n        posts: state.posts.posts,\n        user: state.auth.user,\n        isAuthenticated: state.auth.token !== null,\n    }\n}\n\nexport default connect(mapStateToProps)(PostComponent);\n\n"]},"metadata":{},"sourceType":"module"}